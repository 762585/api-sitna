TC.Control||TC.syncLoadJS(TC.apiLocation+"TC/Control.js"),TC.control.FileImport=function(){var t=this;TC.Control.apply(t,arguments),t.formats=$.isArray(t.options.formats)?t.options.formats:[TC.Consts.format.KML,TC.Consts.format.GML,TC.Consts.format.GML2,TC.Consts.format.GEOJSON,TC.Consts.format.WKT,TC.Consts.format.GPX],t.apiAttribution="",t.mainDataAttribution="",t.dataAttributions=[]},TC.inherit(TC.control.FileImport,TC.Control),function(){var t=TC.control.FileImport.prototype;t.CLASS="tc-ctl-file",t.template=TC.isDebug?TC.apiLocation+"TC/templates/FileImport.html":function(){function o(t,o){return t.w("<h2>").h("i18n",o,{},{$key:"openFile"}).w("</h2><div><p>").h("i18n",o,{},{$key:"fileImport.instructions"}).w('</p><div class="tc-ctl-file-open"><label class="tc-button tc-ctl-file-open-label tc-icon-button"><input type="file" class="tc-ctl-file-open-ipt tc-button" accept="').s(o.get(["formats"],!1),o,{block:e},{}).w('" />').h("i18n",o,{},{$key:"openFile"}).w("</label></div></div>")}function e(t,o){return t.w(".").f(o.getPath(!0,[]),o,"h").h("sep",o,{block:n},{})}function n(t,o){return t.w(",")}return dust.register(t.CLASS,o),o.__dustBody=!0,e.__dustBody=!0,n.__dustBody=!0,o},t.register=function(t){var o=this;TC.Control.prototype.register.call(o,t),o.options.enableDragAndDrop&&t.wrap.enableDragAndDrop(o.options),t.on(TC.Consts.event.FEATURESIMPORT,function(o){var e="."+TC.Consts.format.GPX.toLowerCase();o.fileName.toLowerCase().indexOf(e)!==o.fileName.length-e.length&&t.addLayer({id:TC.getUID(),title:o.fileName,type:TC.Consts.layerType.VECTOR}).then(function(e){for(var n=0,r=o.features.length;r>n;n++)e.addFeature(o.features[n]);setTimeout(function(){t.zoomToFeatures(e.features)},100)})})},t.render=function(){var t=this;t.renderData({formats:t.formats},function(){t._$div.find("input[type=file]").on("change",function(o){t.map&&t.map.wrap.loadFiles(o.target.files)})})}}();