TC.control=TC.control||{},TC.control.MapContents||TC.syncLoadJS(TC.apiLocation+"TC/Control.js"),function(){for(var e=0,t=["ms","moz","webkit","o"],i=!(!window.performance||!window.performance.now),a=0,r=t.length;r>a&&!window.requestAnimationFrame;a+=1)window.requestAnimationFrame=window[t[a]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[a]+"CancelAnimationFrame"]||window[t[a]+"CancelRequestAnimationFrame"];if(window.requestAnimationFrame||(window.requestAnimationFrame=function(t,i){var a=(new Date).getTime(),r=Math.max(0,16-(a-e)),n=window.setTimeout(function(){t(a+r)},r);return e=a+r,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)}),!i){var n=window.requestAnimationFrame,o=+new Date;window.requestAnimationFrame=function(e,t){var i=function(t){var i=1e12>t?t:t-o;return e(i)};n(i,t)}}}(),function(){TC.Consts.classes.THREED=TC.Consts.classes.THREED||"tc-threed",TC.control.ThreeD=function(){var e=this;TC.Control.apply(e,arguments),e.crs="EPSG:4326",e.crsPattern=/(EPSG\:?4326)/i,e.currentMapCfg={baseMap:"",baseMaps:[],baseVector:""},e.workLayers=[],e.selectors={divThreedMap:e.options.divMap},e.Consts={BLANK_BASE:"blank",DEFAULT_TILE_SIZE:256}},TC.inherit(TC.control.ThreeD,TC.Control);var e=TC.control.ThreeD.prototype;e.CLASS="tc-ctl-threed",e.classes={MAPTHREED:"tc-map-threed",LOADING:"tc-loading",BTNACTIVE:"active",CAMERACTRARROWDISABLED:"disabled-arrow",BETA:"tc-beta-button",FOCUS:"focus",HIGHLIGHTED:"highlighted",DISABLED:"disabled",OUTFOCUS:"outfocus"},e.direction={TO_TWO_D:"two_d",TO_THREE_D:"three_d"},e.threeDControls=["attribution","basemapSelector","listTOC","selectContainer","externalWMS","layerCatalog","click","fullScreen","loadingIndicator","navBar","state","fullScreen","threeD"],e.template={},TC.isDebug?(e.template[e.CLASS]=TC.apiLocation+"TC/templates/ThreeD.html",e.template[e.CLASS+"-overlay"]=TC.apiLocation+"TC/templates/ThreeDOverlay.html",e.template[e.CLASS+"-cm-ctls"]=TC.apiLocation+"TC/templates/ThreeDCameraControls.html"):(e.template[e.CLASS]=function(){function t(e,t){return e.w('<button class="tc-ctl-threed-btn" title="').h("i18n",t,{},{$key:"threed.tip"}).w('"></button>')}return dust.register(e.CLASS,t),t.__dustBody=!0,t},e.template[e.CLASS+"-overlay"]=function(){function t(e,t){return e.w('<div class="tc-ctl-threed-overlay" hidden><svg class="tc-ctl-threed-overlay-svg"><defs><filter id="fGaussian" x="0" y="0"><feGaussianBlur in="SourceGraphic" stdDeviation="3" /></filter></defs><rect width="100%" height="100%" fill="white" fill-opacity="0.5" filter="url(#fGaussian)" /> </svg> </div>')}return dust.register(e.CLASS,t),t.__dustBody=!0,t},e.template[e.CLASS+"-cm-ctls"]=function(){function t(e,t){return e.w('<div><div class="tc-ctl-threed-cm-tilt"> <button class="tc-ctl-threed-cm-up-arrow" title="').h("i18n",t,{},{$key:"threed.tilt.left"}).w('"><img src="data:image/png;base64,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" /></button><div><svg width="95" height="95" viewBox="0 0 145 145" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><pattern id=\'video\' width="100%" height="100%" viewBox="25 27 100 100"><image x="40" y="40" height="65" width="65" xlink:href=\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEEAAABBCAYAAAH58PnTAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAA7NSURBVHjaYvj//z8DGk4CYlUgFgfiEiBmZGGAAgMDA4YLFy4EmpiYzGVAAmfOnJFlgnEuXrwIoq7A+MzMzDDmPpCiyUDdQFP/c5mamt6Cyfz9+xfG1ANZJwViARV+ZcAODJgYiACkKQL6ogSHmn+MQAfLABk8QHwDiPWBOARJwX8g7gYIIPSAFAbiMiBmAuI0IFZBCUgWFpY3UGs9gT51QHHL5cuXQQr+Qbl74I4FBR6QLgAGmO6fP3+YoOHUguIboEA/kJqEzSuMxsbG/6Hx8g9oChPO8JCWlv6KN8DWrVuXjNUKoF9BEvNAbCAuhQYcDFwCCCD0gGJgZGQEY1Cg7d279zzIjSBsYWHxByjmOWfOnOswMUtLy79AMUMWdGvV1NRgTJ+ysjIDGOf379/Md+7cqZs+fboGTOzXr18gbxSAnKoOZIQD8QEgPqatrf3n6tWrIMOdgbgCpPjnz59M7OzsoMh4DMSyUAMY2djYQCEZBzJkLTDMg5BS0gIgdQgoNo+YJAhUvxbDO0DNCTw8PNEMxANGrAn++/fvzCQYgj3XnDx58iAphrBAMwqDoKDgj927d4Myy04glgfiO0SasQ8ggEABi88CIyD2BOIL0CzyC4jNgNgFiM+DxDAClYmJieHfv3+gVOkHDOC1SDEwFUidRY4xoFg/hgF6enogirOiomIyWmxlA/FLZDFgAVeIEZg/fvwA5z5gOSqILnf37l1+ZD7I+xgG3L59G0R93bFjRzeyeGJi4i1gQC9EFsvIyLgBCsQYIFsIiFcA8StoRgMVsRlAbAt0CQ+wQPoCyipA/AGIRYF+5wV65zOQvRBeYkybNu2smZlZPJB5E5j+p1tZWaUQikNQ6Q/3QlZWlrGLi8tZINN9wYIF9sQkAlDNgBIGHz58YAeWC1soStLAohNUvv6nKE+AApIiAyjOlUBvMJJtgL6+/ls8GQy/Ac3NzZfmzp3rSpYXgKlriaenpzuotZCWlraUGM3AwhZcC3sA2VxAvAOIv0Hl+KHlgBa0wsEGPgHxNoAAxFc9SEJRGH2CkiSlQ04tIUpgNGSUlCASuBgIPTSIwMJcBKUGoRYNg3CNaAlCkRqkoB+s3PtxaQzM/pagLKXBIiiK6nzxFEnTJB99cOD93Hfvud+795zvMiXKnZJGVGBIQqAZYIEVj8dzg2X/xrLsQzQaPcazGaCHc/sWYBg7fNPlct2h3avFYnkgQ8PzaUALNAoqJV2pVOavYVykQeT14+hwBOJV8hupVPqMgSJ436LVag0/jSGXy59isdhExfUok8nyQEiATqPROPQTAYpsNiuGebbBovXlJpnJZKi/vook0DAP0k7gyul0npddZZB4uPgTxKZsO273XtDvqMNFAyDmNPCRG+xrquiMSSQSXx9g9vQ7moBeYMxsNhtSqVR94WwhuqcOh4Pc7oBrOwjB0ufKtdzgbrc7abPZlnC7QSRGTSbTQjqdptR8YItsc4J9CNyCxAuRQDvqUI9/OOX1eruYGkQkEtnFmpsjEqtQfev3NEGzrwOBwAputzj/7ggGg/MwhFamhoFJL1OKisoVSi+8rRnkJuGqcTxaBPoLU1rDkAgrtSBCIDNgt9vPRCIRw0f8embhcFhZjZnxQoLPqIaE4N9JhEKhI5w5BP9CQqfTpbCNZtVqdZSvTAg5dSzaEfF4fA8HJaqg96nSJJ1QKBQsDxwyJFZm1MBTfr+/GzJ6CV9Yw4sd4IT8XqVSvaOgJskmaW+nE7vP57Mmk0npX0bWaDT3qP6paFn/FIBd8wtpMozCuBtim7mlRa4IshpFdSHiVRcyUAutGAhjGE0I3EV3pXaVCIGDUIoJXkQ3gezOv9CNFxFNoTAczSAlFuJgTk1ii4a4Sls9jx3HNtg+1LVRJByY395v7/nenfOe33neqXbCTwkBqoUdEWA5K9V1CTbHJgD2meAroHNMxp2W+4IirixsjdsF0JTAqmF3p6am3hBkEDObbW1ty7g2QoARkCHQXIA5RkdHZy0WS6Smpmajo6NjBdcGYddgxxVXgOU4LqPEYkVs1GHXGxoa2kOhkCa11qB6frDb7Q/kSS8DZm4lqEPxcSh+s6i+93dKU4coD7S0tDgRBwfTOQy0e2UwGHzNzc2W1KYscdzk5OSgYkqiiY+b9GHV6SaXVSoAP7LPPLWwsHAg0zjwaK1isUJtSKpukUikQukev9+vW11dLVJa3XA4vE/RgbW1taSWDg59lWDM1DjGysrKNrKyK0aj0biRU4uLi98r3YMADYrCk/EP3XFI0YHFxcWCYDC4ZZLfnt7e3pl0LSSDq7u7m6LGs87OzneZIBYxMKwWgGVTT52SzJ5EJYQULjdSSSWby1JdXd1TOPE29UN1Ot3G9PQ09TC26vPYI9w2m82f6izGffN4PCNUWpiGtdzvZdeaFwmGghnX/KdGo6H2oRIt8KRINaZtQY0im8/n01ZWViaqjp+k1hyVurM1DmmsJeLLGD7AUCFSyo46YGNaNDU1Bbq6ulx4gxTtYz2I/e5cuConYFaz2dwOdN+/10qESlvlcrmWVVar9QvyVb/9Rnl5eXR8fHwILwdhXlhInv4qlvRxIBAoyVY5bGxsDKhTGRC9hBbReQNfzR38e0ligxvP6WxOvi1dpRVJgOz1ExMTdMIslcyQbSDgPBnTEGlS1d/ffxsvr8hK5B7PECjGgYGBiymKeG4hFW3b+bxSMjNxfX1dnTcHEo4A/r2O6b8Df48DpaWlm3lzIOGAMT8OAJ9f/skmVUlsYq/4XEAkdw4Qr9xuN5tVKmo8BK7I2VdgMpk+YnIeDT+CvZbGcynbk/N3A2q9Xp/E7319fTNOp/MhNSvhNp42UZqfoxqaTQdaW1u9hNJ7INd2cL96bGzsBa4Pi6K6Qpbk6RSIePsXB/Ver/dmT0/Pub3oSMiqHw6Hw2M0Gp/QARIxP7BIenvCaBiWmvfUoA+LHnBGXhfuYv7vorxwHt8vAdq3tlhIzzA8YzFda+kahxk7NYzj9IjVdu0Su+KicyN6IcoVjUPSSiSUhPRCREhwIxHitpS4cSGVaCR70RKJktZmmaXjMLUOsY4rdOws0/cZ799MdFjmpzW1X/KH+TP/N9/3fO/heZ/v+x0RKI4t349J5UAKiu1bXIPIGU2w7JCBgYEYouvq8fFxb1A0ou0vCJl5ooSPZTIZRAwj299zNoU97hr9eTEQYGtqWsWwoaGhj6iYUlB/XjS2A+pvW61WPyO7BsGes+lvVejvQkEgAFx4sN5cp2D1PjQajfdra2vfpQLJF88fHYNQ/xIYL8j2DQkJCQPsEwYevIXBBF+O6e/vT2psbAyjovzGSfOJjIzcKCkpmY6Njf2Z+4MlLIgG4bhSFQdcWJrypyuUrjiqBj7Lzc29S4W/7LS/K/RfXV39G9XeP/Fq4uEg8suEwsLCOJy6OKMvWtBfSkoKNi6GRYMQFBRk9z6VU4L/YvU/pWonvaysLOak3bLXWRwFLkNRUZFVMOjt7ZVXVlZ+4Oj4AW5+fv7TvLy870WzI19fX7sXBzm4wW1aqfco1Ec4CoBQJnR1dWkALibe1NQUKmYB8SzlPrhoqKtYEI6IakcTL2QG2d7enufOzo7o7SGUKuRKrktLS5a1tbXr55QiZaItAcKevYvTG/bnt4juLERFRW2K/S2FQrFLwW03MDDwZURExPpZTl/YcwdPT0+Qk3XRIBwnvXMqg9Y3S9cYEYsBf3//XUcGjmfc3Nz26+vrnxBpwTGj5ZaWlgm5XG5yFADwUIopw/RxAoFRyqZr+9fqhhyFhb92HZBWRULm+Y8swfxAxpok8vj7dN1tbm5+iH1LeycQj2vJyckLdXV1g6xLPuOxYIMktqqqKrGnp0d12smjpaenGylIowLAjvITKW+ue3EQu8kBzcIa5hYTim3+/IqF1L8bTgpgy4n8XjgtIJAjAACp8RZrX2rO6xBi5BQjrlGgC6Aor1xcXPQgf7dugbu7u+/7+fn9SdxgLSsra1GlUsGizMwRFng8Eh7zbe7TVa/Xe3R0dCipxPHd2tpyt+1PqVTuxsfHP8/Ozl6ioG1mnRbXU4EnJIOG0kBi29rakqgzOfmeSafTGZOSkvDFKaay80w1heMSAMRiCwL1dc1m9TFxDVKk2WyO6uvri5mcnLxpxx0s4OVk7tbUQd914Q0gqYOmbqF0aoGWD7e07Q/34+LiNhMTE+dYooXUPg0Qvi0uLv5qcHBQeXT3CQ1np8gX9T4+Pr/yQ7/zioDbQ5k2k6/vr6ysSI+QozvEDVJLS0vj4WZi+ch5K6g0n11yzR+Ilf4IEL4js0udmpryfl1gInJhIJPSs29OMHtbYbfZZxPF6n88OjqaXlBQcF9yiZtWq90i67ceR7lxmgwAHyOCEknmlEagfUPuA737S5ab73BBBPKBnd93yDcDJJe8seX7O0SWYDWpqan3yJfjqRYwEPUckeDw92FKhEUFwDclztFcXUQiKW1tbQ2nsjezpqYmj259ITnc/VJJnKidi7IKd+nu7tZQPr+3vr7+tsTJ2rnKy9vb2+5U2mqvNAiwCIPBcGtjY8OVsonlSoIgkBUxhc3/AgRnbG9AeAPCBYEAEROFymWqFf5VECCGEleY9/Ly2ufzS85BGc+zMktLS5utqKgwCunySoFAtHm1sbHxMdXws1xNqp0pJriKWfnMzMyZ4uJiFE7DrPzssZgi5ZLaaUA4k90GBwdv19XVjWs0Gkwer5VPsuoExcmTpTA1a5fO0EwAYfWk1/as59hcXA5ycnKm8fqmjaAC01+WHGp+wttJL/nedEZGxi9dXV1BqCcuY3zAvPAuMP07B2Xp60ePHn1OAe0hFGBhwPgSNjAbGhr0CoXCVlqD2itIa5j0AVIiC6zCrhNKaRRSn1Cs0HV2doad5f3Ii24eHh7m8vLyCZ1O10MfRwACVCGNyWSKbG9vfzA2NhZCk1+lSD+qUqmmeMX/kBzKaMKqvxLcKDw8XDIzM2PNBgwEdppw+hYltZKDZMjIyEi0Xq8PJ8Cu/1eTp9/ejI6O1mu1Wry7MMfzWv4LmdcMOPELkX0AAAAASUVORK5CYII=\'></image></pattern></defs><g class="tc-ctl-threed-cm-tilt-outer tc-ctl-threed-cm-tilt-outer-circle"> <title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w('</title> <path d=" M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z "></path></g> <g class="tc-ctl-threed-cm-tilt-outer tc-ctl-threed-cm-tilt-outer-shell-circle"><title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w('</title><path d="M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z m 0,1.75 c 13.842515,0 26.368948,5.558092 35.5,14.5625 l -11.03125,11 0.625,0.625 11.03125,-11 c 8.9199,9.108762 14.4375,21.579143 14.4375,35.34375 0,13.764606 -5.5176,26.22729 -14.4375,35.34375 l -11.03125,-11 -0.625,0.625 11.03125,11 c -9.130866,9.01087 -21.658601,14.59375 -35.5,14.59375 -13.801622,0 -26.321058,-5.53481 -35.4375,-14.5 l 11.125,-11.09375 c 6.277989,6.12179 14.857796,9.90625 24.3125,9.90625 19.241896,0 34.875,-15.629154 34.875,-34.875 0,-19.245847 -15.633104,-34.84375 -34.875,-34.84375 -9.454704,0 -18.034511,3.760884 -24.3125,9.875 L 37.0625,36.4375 C 46.179178,27.478444 58.696991,21.96875 72.5,21.96875 z m -0.875,0.84375 0,13.9375 1.75,0 0,-13.9375 -1.75,0 z M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z M 22.84375,71.625 l 0,1.75 13.96875,0 0,-1.75 -13.96875,0 z m 85.5625,0 0,1.75 14,0 0,-1.75 -14,0 z M 71.75,108.25 l 0,13.9375 1.71875,0 0,-13.9375 -1.71875,0 z"></path>	</g><g class="tc-ctl-threed-cm-tilt-indicator" hidden><path d="M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z"></path></g><g class="tc-ctl-threed-cm-tilt-inner"><title>').h("i18n",t,{},{$key:"threed.tilt.reset"}).w('</title><path d="M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z"></path></g></svg> </div> <button class="tc-ctl-threed-cm-down-arrow" title="').h("i18n",t,{},{$key:"threed.tilt.right"}).w('"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAARCAYAAAHRZ37kAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAbKSURBVHjaYvj//z8XELsBMQsQq/z9+zccSAuzXL16NSA+Pn4pAxLYsWNHNSNQFsRmAmIRqLg0EJ8HCCCGffv2pYK0AjHznj17OoG0LqOZmRnQyL9MyMYwgIwAYh4glnzz5o09yHKAAAKZ625iYrIDpMDa2vqln5/fGVFR0ZcfPnzQLyoqMgaJs7Gx/ZWTk3sNUswO5Gveu3cvaP369dEnT54U+f37NxMQ/FdTU/t89uxZ4V27dsUB1WwCCCCQVRp3795NA9LqUP8yAzHHjBkzql+8eFECZDsAsTxIjmX+/PnLpk6daigkJPQjKirqlqam5iWgBOunT5/Mvb29FUDOADrhi4GBwTzGnJyc+8ePH1dgwAO8vLyeNjU1+YLcLAbk22zZsiVl06ZNZkCrOVlZWf8JCwv/PHfunHBpaemR8PBwkJsfwIIIhNmAWAgUVEAsAcRKQAPioQENVgMQQCCTlX79+uUWGxvb+uXLF05g0N0FunWHjIzMBaBpz4H4IxD/AOJ/QMwFxNqFhYV1J06cUBQREfmhoaHxSUVF5aW+vv4VIH2Ng4PjNg8Pzw1GoIIioB97gBYwovuLkZHxP9D5/4Gxy8DCAko8/xn//PnD+O/fP0ZcYQF00MeYmJh2kItVgAqNgOkk6MCBA7YXLlwQfPfuHTvQACYGIgEoMYSFhd3Ny8vrAcb7UaDQI0ZjY2OGM2fOgFzABsScQCwATakiX79+FQUlOyDNxc7O/g/oxV8/fvz4x8XFxQ1MvJaTJk1yLi4uXmdvb78KqP4iEL8F4l8gywACMFI9LwmEQZR1PRjWalDpKqYkYunNLgq2x4hAPPkHeOwQBCEYgnj0P/CgefMUeOjYKQiCjoLBokk/lEBRZM22FnLpjX2ChAcXHst+zDc78+bNo4ptaNVfrVYPEomEjLM28M64paAJSZtiAUutVgtBhceQ9Njj8XQEQaD4PjAExsAnzcRIMq5UKufFYvEIfPfj8fgDurg1m80tdoECf1hiO6o+LBQKZ1arVRNF8SsYDCqBQKCBn8her7eObhqIe+J6vV4WZF8MBgMT40t3u90fCB75/f5XqorneQ3KMaC7TSyaM5/P76mqapxxTPtEPDudThWqeEkmkykOttCq1+s7CxQxvYCk+vwxqYJplVswRD0ajd6n0+mUEdp7VBRlq91ur/73C3DPAfwyyqDdzWQyNxjkJc2Jx3TfJEnqwE+E4XBohgKMlJBxutTj8/mUXC53FQ6HS/ikxRpQWwKT1zY2b7fZbIawy/uyLDu63a4JZ1MuNU0z0JKgMhraNwqyky1GIpEe9r7kcrmuEUaDG5GSZjqmy2R0a8A6sImENvBpxebRUA0wPdq4CdQwAfdiLBY7xd3nbDZbxPfd1Ez+FKTPe+8MHDP+FcACbDCTERlsgIOcvFwun+AtkdeweG4+168AvZZPbxJRFMWhMFC0lCIRCDGpUBMXRlImJSw0hpU7Iybu/VZ8BcOCBRt3JC4ajenGhUFh42AAS7HSSGVSGIq/q/clpNWFC33JzXsTmHn33znnykNCPBQ9IA136vX6w263u02bjYvFogMtO+DfWQHBBJsqMc3VDIiWpnsUyTEsRdr2Go3Gk8FgcIs0zmhLN51On0KhY4jskPSOwMcxYBuznyjQppoBV3d5dsXhPQ63qdWDarX6GA25bqQKEM2j0eg8m81+z+Vyp1z0mfOneDw+TKVSQy440Q/OFJyS3iV1DlKaMCWJS+b43g5gtWu12vZFbgNPC8zjroWwMEHMOHuoy5D9iPeP2D8S1HsY+oO/3+8/Q9SeNpvN+51OJ6Yd/NslOKThhOM8mMSLRCKeBMR5IeXiefGrG36y9prrugFpUtmROgtZjggx+P5y4eyxbdsvKpXK8yDl30Ksdnu93qaODX9cIhtcGEAFxMK+f7io3iyfz4+xd7TmS9jwACLq+lGDe47j3CXTu+1222YIuikwxiKrtPg/Fiy6hK9cKOJLuVx+UyqV9qmoaEJfMTQxoDP0kCCDabJ3AwbNkf0sjmfI/pYEgR6sQ3wWgQQujWTaMoYhVsC3FFoXQzI9aGYO+K5c6GOPDH6DxruQ4z4T04HSzqECfWoUUhxe0+kxoMhe15HkKrahwcRw8hqClKAXEwxKSfpyE9ugV8PsISoVEu2QtsF89DVUOD+nr2c46ZGpcDKZtFqtVow5bwfetADvGQ6OcPQtHPmaXm2pjI+UjdxVMEtwQX041x/OlFL8K0HIfyyQGhLLZDIh0BrS4Cz9T0DfMYA1FGcuCmoCogSXgyof4dyEOeNVoVCQkg81m1+VwgzrXALVD/k+37CYqFN0AAAAAElFTkSuQmCC" /></button> </div><div class="tc-ctl-threed-cm-rotate"><div class="tc-ctl-threed-cm-rotate-buttons"><button class="tc-ctl-threed-cm-left-arrow" title="').h("i18n",t,{},{$key:"threed.rotate.left"}).w('"><img src="data:image/png;base64,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" /></button><button class="tc-ctl-threed-cm-right-arrow" title="').h("i18n",t,{},{$key:"threed.rotate.right"}).w('"><img src="data:image/png;base64,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" /></button></div> <div><svg width="95" height="95" viewBox="0 0 145 145" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><pattern id=\'arrow\' width="100%" height="100%" viewBox="22 30 100 100"><image x="40" y="40" height="65" width="65" xlink:href=\'data:image/png;base64,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\'></image></pattern></defs><g class="tc-ctl-threed-cm-rotate-outer tc-ctl-threed-cm-rotate-outer-circle"><title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w('</title><path d=" M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z "></path></g> <g class="tc-ctl-threed-cm-rotate-outer tc-ctl-threed-cm-rotate-outer-shell-circle"><title>').h("i18n",t,{},{$key:"threed.rotate.drag"}).w('</title><path d="M 72.5,20.21875 c -28.867432,0 -52.28125,23.407738 -52.28125,52.28125 0,28.87351 23.413818,52.3125 52.28125,52.3125 28.86743,0 52.28125,-23.43899 52.28125,-52.3125 0,-28.873512 -23.41382,-52.28125 -52.28125,-52.28125 z m 0,1.75 c 13.842515,0 26.368948,5.558092 35.5,14.5625 l -11.03125,11 0.625,0.625 11.03125,-11 c 8.9199,9.108762 14.4375,21.579143 14.4375,35.34375 0,13.764606 -5.5176,26.22729 -14.4375,35.34375 l -11.03125,-11 -0.625,0.625 11.03125,11 c -9.130866,9.01087 -21.658601,14.59375 -35.5,14.59375 -13.801622,0 -26.321058,-5.53481 -35.4375,-14.5 l 11.125,-11.09375 c 6.277989,6.12179 14.857796,9.90625 24.3125,9.90625 19.241896,0 34.875,-15.629154 34.875,-34.875 0,-19.245847 -15.633104,-34.84375 -34.875,-34.84375 -9.454704,0 -18.034511,3.760884 -24.3125,9.875 L 37.0625,36.4375 C 46.179178,27.478444 58.696991,21.96875 72.5,21.96875 z m -0.875,0.84375 0,13.9375 1.75,0 0,-13.9375 -1.75,0 z M 36.46875,37.0625 47.5625,48.15625 C 41.429794,54.436565 37.65625,63.027539 37.65625,72.5 c 0,9.472461 3.773544,18.055746 9.90625,24.34375 L 36.46875,107.9375 c -8.96721,-9.1247 -14.5,-21.624886 -14.5,-35.4375 0,-13.812615 5.53279,-26.320526 14.5,-35.4375 z M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z M 22.84375,71.625 l 0,1.75 13.96875,0 0,-1.75 -13.96875,0 z m 85.5625,0 0,1.75 14,0 0,-1.75 -14,0 z M 71.75,108.25 l 0,13.9375 1.71875,0 0,-13.9375 -1.71875,0 z"></path>	</g><g class="tc-ctl-threed-cm-rotate-inner"><title>').h("i18n",t,{},{$key:"threed.rotate.reset"}).w('</title><path d="M 72.5,39.40625 c 18.297686,0 33.125,14.791695 33.125,33.09375 0,18.302054 -14.827314,33.125 -33.125,33.125 -18.297687,0 -33.09375,-14.822946 -33.09375,-33.125 0,-18.302056 14.796063,-33.09375 33.09375,-33.09375 z"></path></g></svg> </div> </div><div class="tc-ctl-threed-cm-help"></div></div>')}return dust.register(e.CLASS,t),t.__dustBody=!0,t}),e.viewer,e.mapView,e.terrainProvider,e.register=function(e){var t=this;TC.Control.prototype.register.call(t,e),t.mapView=new MapView(e,t)},e.renderData=function(e,t){var i=this;TC.Control.prototype.renderData.call(i,e,function(){i.getRenderedHtml(i.CLASS+"-overlay",{},function(e){i.overlay=$(e)}),i.beforeBaseLayerChanged=i.BaseMap.Events.beforeBaseLayerChanged.bind(i),i.baseLayerChanged=i.BaseMap.Events.baseLayerChanged.bind(i),i.layerAdded=i.Layer.Events.layerAdded.bind(i),i.layerRemoved=i.Layer.Events.layerRemoved.bind(i),i.layerVisibility=i.Layer.Events.layerVisibility.bind(i),i.layerOpacity=i.Layer.Events.layerOpacity.bind(i),i.layerOrder=i.Layer.Events.layerOrder.bind(i),i.initialExtent=i.OverrideControls.Events.initialExtent.bind(i),i.zoomin=i.OverrideControls.Events.zoomin.bind(i),i.zoomout=i.OverrideControls.Events.zoomout.bind(i),
i.$button=i._$div.find("."+i.CLASS+"-btn"),i.$button.on(TC.Consts.event.CLICK,function(){i.$button.attr("disabled","disabled"),i.waitting||(i.waitting=i.map.getLoadingIndicator().addWait());for(var e=[],t=0,a=i.threeDControls.length;a>t;t++){var r=i.threeDControls[t];r=r.substr(0,1).toUpperCase()+r.substr(1),e=e.concat(i.map.getControlsByClass("TC.control."+r))}i.ctrlsToMng=e,i.mapIs3D?i.cameraControls.resetRotation({duration:1e3}).then(function(){var e=function(){i.mapIs3D=!1,i.map._$div.removeClass(TC.Consts.classes.THREED),i.$button.attr("title",i.getLocaleString("threed.tip")),i.Cesium.CustomRender.stop(),i.map.off(TC.Consts.event.BEFOREBASELAYERCHANGE,i.beforeBaseLayerChanged),i.map.off(TC.Consts.event.BASELAYERCHANGE,i.baseLayerChanged),i.map.off(TC.Consts.event.LAYERADD,i.layerAdded),i.map.off(TC.Consts.event.LAYERREMOVE,i.layerRemoved),i.map.off(TC.Consts.event.LAYERVISIBILITY,i.layerVisibility),i.map.off(TC.Consts.event.LAYEROPACITY,i.layerOpacity),i.map.off(TC.Consts.event.LAYERORDER,i.layerOrder),$(".tc-ctl-nav-btn-home").off("click",i.initialExtent),$(".tc-ctl-nav-btn-zoomin").off("click",i.zoomin),$(".tc-ctl-nav-btn-zoomout").off("click",i.zoomout),i.OverrideControls.adapter.call(i,i.direction.TO_TWO_D),i.BaseMap.synchronizer.call(i,i.direction.TO_TWO_D),i.Util.reset3D.call(i),i.Cesium.setViewFromCameraView.call(i).then(function(){i.$divThreedMap.removeClass(i.classes.MAPTHREED),i.$divThreedMap.removeClass("tc-ctl-threed-divMap-fadeIn").addClass("tc-ctl-threed-divMap-fadeOut"),$(i.mapView.viewHTML).removeClass("tc-ctl-threed-divMap-fadeOut").addClass("tc-ctl-threed-divMap-fadeIn"),i.viewer.destroy(),i.viewer=null,i.$button.removeAttr("disabled"),i.$button.toggleClass(i.classes.BTNACTIVE),i.map.getLoadingIndicator().removeWait(i.waitting),delete i.waitting})},t=i.Cesium.Util.pickBottomPoint(i.viewer.scene),a=Cesium.Matrix4.fromTranslation(t),r=i.Cesium.Util.computeAngleToZenith(i.viewer.scene,t);i.Cesium.Util.rotateAroundAxis(i.viewer.scene.camera,-r,i.viewer.scene.camera.right,a,{duration:1500,callback:e})}):(i.Util.browserSupportWebGL.call(i)||!i.Util.browserSupportWebGL.call(i))&&(i.mapIs3D=!0,i.overlay.removeAttr("hidden"),i.overlay.appendTo(i.map._$div.parent()),i.map._$div.addClass(TC.Consts.classes.THREED),i.$divThreedMap=$("#"+i.selectors.divThreedMap),i.$divThreedMap.addClass(i.classes.MAPTHREED),i.$divThreedMap.addClass(i.classes.LOADING),i.$button.attr("title",i.getLocaleString("threed.two.tip")),i.$button.removeClass(i.classes.BETA),i.Cesium.getViewer.call(i).then(function(e){i.$divThreedMap.removeClass("tc-ctl-threed-divMap-fadeOut").addClass("tc-ctl-threed-divMap-fadeIn"),$(i.mapView.viewHTML).removeClass("tc-ctl-threed-divMap-fadeIn").addClass("tc-ctl-threed-divMap-fadeOut"),i.$divThreedMap.removeClass(i.classes.LOADING),i.$button.toggleClass(i.classes.BTNACTIVE),i.OverrideControls.adapter.call(i,i.direction.TO_THREE_D),i.Cesium.setCameraFromMapView.call(i),i.BaseMap.synchronizer.call(i,i.direction.TO_THREE_D),i.Layer.synchronizer.call(i),$.when(i.viewer.readyPromise).then(function(){i.cameraControls?i.cameraControls.render.call(i.cameraControls):i.cameraControls=new CameraControls(i);var e=Cesium.Math.toRadians(50),t=i.Cesium.Util.pickBottomPoint(i.viewer.scene);t=Cesium.Matrix4.fromTranslation(t);var a=function(){i.$button.removeAttr("disabled"),i.overlay.attr("hidden","hidden"),i.map.getLoadingIndicator().removeWait(i.waitting),delete i.waitting};i.Cesium.Util.rotateAroundAxis(i.viewer.scene.camera,-e,i.viewer.scene.camera.right,t,{duration:2e3,callback:a})}.bind(i)),i.map.on(TC.Consts.event.BEFOREBASELAYERCHANGE,i.beforeBaseLayerChanged),i.map.on(TC.Consts.event.BASELAYERCHANGE,i.baseLayerChanged),i.map.on(TC.Consts.event.LAYERADD,i.layerAdded),i.map.on(TC.Consts.event.LAYERREMOVE,i.layerRemoved),i.map.on(TC.Consts.event.LAYERVISIBILITY,i.layerVisibility),i.map.on(TC.Consts.event.LAYEROPACITY,i.layerOpacity),i.map.on(TC.Consts.event.LAYERORDER,i.layerOrder),$(".tc-ctl-nav-btn-home").on("click",i.initialExtent),$(".tc-ctl-nav-btn-zoomin").on("click",i.zoomin),$(".tc-ctl-nav-btn-zoomout").on("click",i.zoomout)}))})}),$.isFunction(t)&&t()},e.activate=function(){var e=this;TC.Control.prototype.activate.call(e)},e.deactivate=function(){var e=this;TC.Control.prototype.deactivate.call(e)},MapView=function(e,t){this.map=e,this.parent=t,$.when(this.map.getViewHTML()).then(function(e){this.viewHTML=e}.bind(this)),this.proj4Obj=proj4(this.map.crs),this.proj4Obj.oProj.METERS_PER_UNIT=1,this.maxResolution},MapView.prototype.getCenter=function(){return this.map.getCenter()},MapView.prototype.getExtent=function(){return this.map.getExtent()},MapView.prototype.getResolution=function(){return this.map.getResolution()},MapView.prototype.getRotation=function(){return this.map.getRotation()},MapView.prototype.getMaxResolution=function(){if(this.maxResolution)return this.maxResolution;if(null!==this.map.getResolutions())this.maxResolution=this.map.getResolutions()[0];else{var e=this.map.options.baselayerExtent;this.maxResolution=(e[2]-e[0])/this.parent.Consts.DEFAULT_TILE_SIZE}return this.maxResolution},MapView.prototype.setCenter=function(e){this.map.setCenter(e)},MapView.prototype.setExtent=function(e){this.map.setExtent(e)},MapView.prototype.setResolution=function(e){this.map.setResolution(e)},MapView.prototype.setRotation=function(e){this.map.setRotation(e)},CameraControls=function(e){var t=this;t.parent=e;var i=function(){var e=this;e.isFocusingCameraCtrls=!1},a=function(){var e=this;e.isFocusingCameraCtrls=!0,e.lastFocused=performance.now(),e.$div.hasClass(e.parent.classes.OUTFOCUS)&&(e.$div.removeClass(e.parent.classes.OUTFOCUS),e.$tiltIndicatorOuterCircle.attr("class",e.$tiltIndicatorOuterCircle.attr("class").replace(e.parent.classes.OUTFOCUS,"")),e.$tiltIndicatorOuterShellCircle.attr("class",e.$tiltIndicatorOuterShellCircle.attr("class").replace(e.parent.classes.OUTFOCUS,"")),e.$rotateIndicatorOuterCircle.attr("class",e.$rotateIndicatorOuterCircle.attr("class").replace(e.parent.classes.OUTFOCUS,"")),e.$rotateIndicatorOuterShellCircle.attr("class",e.$rotateIndicatorOuterShellCircle.attr("class").replace(e.parent.classes.OUTFOCUS,"")),e.$imgs.css({opacity:"1"}))},r=function(){var e=this;e.moving=!0},n=function(){var e=this;e.moving=!1},o=function(){var e=this;e.parent.Cesium.arePendingTiles.call(e.parent)&&e.customCollisionDetection(),e.moving&&(s(e.$tiltIndicator,e.getCamera().pitch),s(e.$rotateIndicator,-e.getCamera().heading),e.disableTilt(5))},s=function(e,t){var i="rotate("+t+"rad)";e.css({"-ms-transform":i,"-webkit-transform":i,transform:i})};t.outControls=i.bind(t),t.inControls=a.bind(t),t.moveStart=r.bind(t),t.moveEnd=n.bind(t),t.postRender=o.bind(t),t.selectors={tilt:"-cm-tilt",rotate:"-cm-rotate",indicator:"-indicator",leftArrow:"-cm-left-arrow",rightArrow:"-cm-right-arrow",downArrow:"-cm-down-arrow",upArrow:"-cm-up-arrow"},t.render()},CameraControls.prototype.bind=function(){function e(){t.lastFocused||(t.lastFocused=performance.now());var i=performance.now()-t.lastFocused;i>5e3&&t.isFocusingCameraCtrls!==!0&&(t.$div.hasClass(t.parent.classes.OUTFOCUS)||(t.$div.addClass(t.parent.classes.OUTFOCUS),t.$tiltIndicatorOuterCircle.attr("class",t.$tiltIndicatorOuterCircle.attr("class")+" "+t.parent.classes.OUTFOCUS),t.$tiltIndicatorOuterShellCircle.attr("class",t.$tiltIndicatorOuterShellCircle.attr("class")+" "+t.parent.classes.OUTFOCUS),t.$rotateIndicatorOuterCircle.attr("class",t.$rotateIndicatorOuterCircle.attr("class")+" "+t.parent.classes.OUTFOCUS),t.$rotateIndicatorOuterShellCircle.attr("class",t.$rotateIndicatorOuterShellCircle.attr("class")+" "+t.parent.classes.OUTFOCUS),t.$imgs.css({opacity:"0.2"}))),t.rAFInOutControls=requestAnimationFrame(e)}var t=this;t.getCamera().moveStart.addEventListener(t.moveStart),t.getCamera().moveEnd.addEventListener(t.moveEnd),t.parent.viewer.scene.postRender.addEventListener(t.postRender),t.$div.on(TC.Util.detectMouse()?"mouseout":"touchleave, touchend",t.outControls),t.$div.on(TC.Util.detectMouse()?"mouseover":"touchmove, touchstart",t.inControls),t.rAFInOutControls=requestAnimationFrame(e)},CameraControls.prototype.unbind=function(){var e=this;e.$div.addClass(TC.Consts.classes.HIDDEN),e.getCamera().moveStart.removeEventListener(e.moveStart),e.getCamera().moveEnd.removeEventListener(e.moveEnd),e.parent.viewer.scene.postRender.removeEventListener(e.postRender),e.$div.off(TC.Util.detectMouse()?"mouseout":"touchleave, touchend",e.outControls),e.$div.off(TC.Util.detectMouse()?"mouseover":"touchmove, touchstart",e.inControls),window.cancelAnimationFrame(e.rAFInOutControls),e.lastFocused=void 0,e.rAFInOutControls=void 0},CameraControls.prototype.getCamera=function(){var e=this;return e.parent.Cesium.Camera.getCamera.call(e.parent)},CameraControls.prototype.render=function(){var e=this;e.$div?(e.$div.removeClass(TC.Consts.classes.HIDDEN),e.bind()):e.parent.getRenderedHtml(e.parent.CLASS+"-cm-ctls",{},function(t){e.$div=$('<div class="'+e.parent.CLASS+'-cm-ctls"></div>'),e.$div.appendTo(e.parent.map._$div),$(t).appendTo(e.$div),e.$imgs=$.merge(e.$div.find("img"),e.$div.find("image"));var i=function(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();var t=new Cesium.Cartesian2,i=e.currentTarget,a=e.currentTarget.getBoundingClientRect(),r=a.width/2,n=new Cesium.Cartesian2((a.right-a.left)/2,(a.bottom-a.top)/2),o=new Cesium.Cartesian2(e.clientX-a.left,e.clientY-a.top),s=Cesium.Cartesian2.subtract(o,n,t),l=Cesium.Cartesian2.magnitude(s),c=l/r,u=145,m=50;return m/u>c?0:1>c?{element:i,vector:s}:!0};e.$tilt=$("."+e.parent.CLASS+e.selectors.tilt,e.$div),e.$tiltIndicator=e.$tilt.find("svg"),e.$tiltIndicator.on("mousedown",function(e){var t=this,a=i.call(t,e);0==a?t.resetTilt.call(t):a.hasOwnProperty("element")&&t.draggingTilt.call(t,a.element,a.vector)}.bind(e)),e.$tiltIndicatorInner=e.$tiltIndicator.find("."+e.parent.CLASS+e.selectors.tilt+"-inner"),e.$tiltIndicatorInner.on(TC.Consts.event.CLICK,e.resetTilt.bind(e)),e.$tiltIndicatorOuter=e.$tiltIndicator.find("."+e.parent.CLASS+e.selectors.tilt+"-outer"),e.$tiltIndicatorOuterCircle=$("."+e.parent.CLASS+e.selectors.tilt+"-outer-circle"),e.$tiltIndicatorOuterShellCircle=$("."+e.parent.CLASS+e.selectors.tilt+"-outer-shell-circle"),e.$tiltUp=e.$tilt.find("."+e.parent.CLASS+e.selectors.upArrow),e.$tiltUp.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(){e.$tiltUp.blur();var t=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(t,e.tiltUpMouseUpFunction,!1),e.tiltUpMouseUpFunction=void 0,e.tilt.call(e,5),e.tiltUpInterval=setInterval(function(){e.isTiltUpDisabled?e.tiltUpMouseUpFunction():e.tilt.call(e,5)}.bind(e),101),e.tiltUpMouseUpFunction=function(){clearInterval(e.tiltUpInterval),e.tiltUpInterval=void 0,document.removeEventListener(t,e.tiltUpMouseUpFunction,!1),e.tiltUpMouseUpFunction=void 0},document.addEventListener(t,e.tiltUpMouseUpFunction,!1)}.bind(e)),e.$tiltDown=e.$tilt.find("."+e.parent.CLASS+e.selectors.downArrow),e.$tiltDown.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(){e.$tiltDown.blur();var t=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(t,e.tiltDownMouseUpFunction,!1),e.tiltDownMouseUpFunction=void 0,e.tilt.call(e,-5),e.tiltDownInterval=setInterval(function(){e.isTiltDownDisabled?e.tiltDownMouseUpFunction():e.tilt.call(e,-5)}.bind(e),101),e.tiltDownMouseUpFunction=function(){clearInterval(e.tiltDownInterval),e.tiltDownInterval=void 0,document.removeEventListener(t,e.tiltDownMouseUpFunction,!1),e.tiltDownMouseUpFunction=void 0},document.addEventListener(t,e.tiltDownMouseUpFunction,!1)}.bind(e)),e.$rotate=$("."+e.parent.CLASS+e.selectors.rotate,e.$div),e.$rotateIndicator=e.$rotate.find("svg"),e.$rotateIndicatorInner=e.$rotateIndicator.find("."+e.parent.CLASS+e.selectors.rotate+"-inner"),e.$rotateIndicator.on("mousedown",function(e){var t=this,a=i.call(t,e);0==a?t.resetRotation.call(t):1==a.hasOwnProperty("element")&&t.draggingRotate.call(t,a.element,a.vector)}.bind(e)),e.$rotateIndicatorOuterCircle=$("."+e.parent.CLASS+e.selectors.rotate+"-outer-circle"),e.$rotateIndicatorOuterShellCircle=$("."+e.parent.CLASS+e.selectors.rotate+"-outer-shell-circle"),e.$rotateLeft=e.$rotate.find("."+e.parent.CLASS+e.selectors.leftArrow),e.$rotateLeft.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(){e.$rotateLeft.blur();var t=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(t,e.rotateLeftMouseUpFunction,!1),e.rotateLeftMouseUpFunction=void 0,e.rotate.call(e,-15),e.rotateLeftInterval=setInterval(function(){e.rotate.call(e,-15)}.bind(e),101),e.rotateLeftMouseUpFunction=function(){clearInterval(e.rotateLeftInterval),e.rotateLeftInterval=void 0,document.removeEventListener(t,e.rotateLeftMouseUpFunction,!1),e.rotateLeftMouseUpFunction=void 0},document.addEventListener(t,e.rotateLeftMouseUpFunction,!1)}.bind(e)),e.$rotateRight=e.$rotate.find("."+e.parent.CLASS+e.selectors.rightArrow),e.$rotateRight.on(TC.Util.detectMouse()?"mousedown":"touchstart",function(){e.$rotateRight.blur();var t=TC.Util.detectMouse()?"mouseup":"touchend";document.removeEventListener(t,e.rotateRightMouseUpFunction,!1),e.rotateRightMouseUpFunction=void 0,e.rotate.call(e,15),e.rotateRightInterval=setInterval(function(){e.rotate.call(e,15)}.bind(e),101),e.rotateRightMouseUpFunction=function(){clearInterval(e.rotateRightInterval),e.rotateRightInterval=void 0,document.removeEventListener(t,e.rotateRightMouseUpFunction,!1),e.rotateRightMouseUpFunction=void 0},document.addEventListener(t,e.rotateRightMouseUpFunction,!1)}.bind(e)),e.bind()}.bind(this))},CameraControls.prototype.disableTilt=function(e){var t=this,i=Cesium.Math.toRadians(Math.abs(e));t.isTiltUpDisabled=void 0==t.parent.Cesium.Util.pickBottomPoint(t.parent.viewer.scene)?!0:t.getCamera().pitch+i>=Cesium.Math.PI_OVER_TWO,t.isTiltDownDisabled=t.getCamera().pitch-i<=-Cesium.Math.PI_OVER_TWO,t.isTiltUpDisabled?t.$tiltUp.addClass(t.parent.classes.CAMERACTRARROWDISABLED):t.$tiltUp.removeClass(t.parent.classes.CAMERACTRARROWDISABLED),t.$tiltUp.attr("disabled",t.isTiltUpDisabled),t.isTiltDownDisabled?t.$tiltDown.addClass(t.parent.classes.CAMERACTRARROWDISABLED):t.$tiltDown.removeClass(t.parent.classes.CAMERACTRARROWDISABLED),t.$tiltDown.attr("disabled",t.isTiltDownDisabled)},CameraControls.prototype.tilt=function(e){var t=this;if(t.disableTilt(e),void 0==t.parent.Cesium.Util.pickBottomPoint(t.parent.viewer.scene)&&(e>0?t.getCamera().lookUp():t.getCamera().lookDown()),!(e>=Cesium.Math.PI_OVER_TWO&&t.isTiltUpDisabled||e<=-Cesium.Math.PI_OVER_TWO&&t.isTiltDownDisabled)){var i=Cesium.Math.toRadians(e),a=t.parent.Cesium.Util.pickBottomPoint(t.parent.viewer.scene);if(a){var r=Cesium.Matrix4.fromTranslation(a);t.parent.Cesium.Util.rotateAroundAxis(t.getCamera(),-i,t.getCamera().right,r,{duration:100})}}},CameraControls.prototype.rotate=function(e){var t=this;e=Cesium.Math.toRadians(e);var i=t.parent.Cesium.Util.pickBottomPoint(t.parent.viewer.scene);i&&t.parent.Cesium.Util.setHeadingUsingBottomCenter(t.parent.viewer.scene,e,i,{duration:100})},CameraControls.prototype.draggingTilt=function(e,t){var i=this;i.$tiltIndicatorOuterCircle.attr("class",i.$tiltIndicatorOuterCircle.attr("class")+" "+i.parent.classes.HIGHLIGHTED);var a=new Cesium.Matrix4,r=new Cesium.Matrix4,n=new Cesium.Cartesian2;document.removeEventListener("mousemove",i.tiltMouseMoveFunction,!1),document.removeEventListener("mouseup",i.tiltMouseUpFunction,!1),i.tiltTickFunction&&i.parent.viewer.clock.onTick.removeEventListener(i.tiltTickFunction),i.tiltMouseMoveFunction=void 0,i.tiltMouseUpFunction=void 0,i.tiltTickFunction=void 0,i.isTilting=!0,i.tiltLastTimestamp=performance.now();var o=i.parent.viewer.scene,s=o.camera,l=i.parent.Cesium.Util.pickBottomPoint(o);l?(i.tiltFrame=Cesium.Transforms.eastNorthUpToFixedFrame(l,Cesium.Ellipsoid.WGS84,r),i.tiltIsLook=!1):(i.tiltFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s.positionWC,Cesium.Ellipsoid.WGS84,r),i.tiltIsLook=!0);var c=Math.atan2(-t.y,t.x);i.tiltInitialCursorAngle=Cesium.Math.zeroToTwoPi(c-Cesium.Math.PI_OVER_TWO),i.tiltInitialCameraAngle=Math.atan2(s.position.y,s.position.x),i.tiltTickFunction=function(e){var t=this,i=performance.now(),r=(i-t.tiltLastTimestamp,t.parent.Cesium.Util.pickBottomPoint(o));if(r&&!t.tiltLastPivot&&(t.tiltLastPivot=r),!r&&t.tiltLastPivot)r=t.tiltLastPivot;else if(!t.tiltLastPivot)return;var n=t.tiltCursorAngle+Cesium.Math.PI_OVER_TWO,l=n-t.tiltInitialCursorAngle;o=t.parent.viewer.scene,s=o.camera;var c=Cesium.Matrix4.clone(s.transform,a);s.lookAtTransform(t.tiltFrame);var u=Cesium.Math.zeroToTwoPi(t.tiltInitialCameraAngle-l),m=Math.atan2(s.position.y,s.position.x),C=.02*Math.sin(u-m);t.tiltIsLook?s.look(s.right,-C):s.rotateUp(C),s.lookAtTransform(c),t.tiltLastTimestamp=i}.bind(i),i.tiltMouseMoveFunction=function(t){var i=this,a=e.getBoundingClientRect();center=new Cesium.Cartesian2((a.right-a.left)/2,(a.bottom-a.top)/2);var r=new Cesium.Cartesian2(t.clientX-a.left,t.clientY-a.top),o=Cesium.Cartesian2.subtract(r,center,n),s=Math.atan2(-o.y,o.x);i.tiltCursorAngle=Cesium.Math.zeroToTwoPi(s-Cesium.Math.PI_OVER_TWO)}.bind(i),i.tiltMouseUpFunction=function(e){i.$tiltIndicatorOuterCircle.attr("class",i.$tiltIndicatorOuterCircle.attr("class").replace(i.parent.classes.HIGHLIGHTED,"")),i.isTilting=!1,document.removeEventListener("mousemove",i.tiltMouseMoveFunction,!1),document.removeEventListener("mouseup",i.tiltMouseUpFunction,!1),void 0!==i.tiltTickFunction&&i.parent.viewer.clock.onTick.removeEventListener(i.tiltTickFunction),i.tiltMouseMoveFunction=void 0,i.tiltMouseUpFunction=void 0,i.tiltTickFunction=void 0},document.addEventListener("mousemove",i.tiltMouseMoveFunction,!1),document.addEventListener("mouseup",i.tiltMouseUpFunction,!1),i._unsubscribeFromClockTick=i.parent.viewer.clock.onTick.addEventListener(i.tiltTickFunction);var c=Math.atan2(-t.y,t.x);i.tiltCursorAngle=Cesium.Math.zeroToTwoPi(c-Cesium.Math.PI_OVER_TWO)},CameraControls.prototype.draggingRotate=function(e,t){var i=this;i.$rotateInner=$(e).find("."+i.parent.CLASS+i.selectors.rotate+"-outer-circle"),i.$rotateInner.attr("class",i.$rotateInner.attr("class")+" "+i.parent.classes.HIGHLIGHTED);var a=new Cesium.Matrix4,r=new Cesium.Matrix4,n=new Cesium.Cartesian2;document.removeEventListener("mousemove",i.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",i.rotateMouseUpFunction,!1),i.rotateMouseMoveFunction=void 0,i.rotateMouseUpFunction=void 0,i.isRotating=!0,i.rotateInitialCursorAngle=Math.atan2(-t.y,t.x);var o=i.parent.viewer.scene,s=o.camera,l=i.parent.Cesium.Util.pickCenterPoint(i.parent.viewer.scene);null==l||void 0==l?(l=i.parent.Cesium.Util.pickBottomPoint(i.parent.viewer.scene),(null==l||void 0==l)&&(i.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(s.positionWC,Cesium.Ellipsoid.WGS84,r),i.rotateIsLook=!0)):(i.rotateFrame=Cesium.Transforms.eastNorthUpToFixedFrame(l,Cesium.Ellipsoid.WGS84,r),i.rotateIsLook=!1);var c=Cesium.Matrix4.clone(s.transform,a);s.lookAtTransform(i.rotateFrame),i.rotateInitialCameraAngle=Math.atan2(s.position.y,s.position.x),i.rotateInitialCameraDistance=Cesium.Cartesian3.magnitude(new Cesium.Cartesian3(s.position.x,s.position.y,0)),s.lookAtTransform(c),i.rotateMouseMoveFunction=function(t){var r=e.getBoundingClientRect(),o=new Cesium.Cartesian2((r.right-r.left)/2,(r.bottom-r.top)/2),l=new Cesium.Cartesian2(t.clientX-r.left,t.clientY-r.top),u=Cesium.Cartesian2.subtract(l,o,n),m=Math.atan2(-u.y,u.x),C=m-i.rotateInitialCursorAngle,d=Cesium.Math.zeroToTwoPi(i.rotateInitialCameraAngle-C);s=i.parent.viewer.scene.camera,c=Cesium.Matrix4.clone(s.transform,a),s.lookAtTransform(i.rotateFrame);var p=Math.atan2(s.position.y,s.position.x);s.rotateRight(d-p),s.lookAtTransform(c)},i.rotateMouseUpFunction=function(e){i.isRotating=!1,i.$rotateInner.attr("class",i.$rotateInner.attr("class").replace(i.parent.classes.HIGHLIGHTED,"")),document.removeEventListener("mousemove",i.rotateMouseMoveFunction,!1),document.removeEventListener("mouseup",i.rotateMouseUpFunction,!1),i.rotateMouseMoveFunction=void 0,i.rotateMouseUpFunction=void 0},document.addEventListener("mousemove",i.rotateMouseMoveFunction,!1),document.addEventListener("mouseup",i.rotateMouseUpFunction,!1)},CameraControls.prototype.resetTilt=function(){var e=this,t=-e.getCamera().pitch-Cesium.Math.toRadians(50);e.tilt(Cesium.Math.toDegrees(t))},CameraControls.prototype.resetRotation=function(e){var t,i=this,a=new $.Deferred;for(t=-i.getCamera().heading;t<-Math.PI;)t+=2*Math.PI;for(;t>Math.PI;)t-=2*Math.PI;e?e.callback=function(){a.resolve()}:a.resolve();var r=i.parent.Cesium.Util.pickBottomPoint(i.parent.viewer.scene);return r&&i.parent.Cesium.Util.setHeadingUsingBottomCenter(i.parent.viewer.scene,t,r,e),a},CameraControls.prototype.customCollisionDetection=function(){{var e,t,i=this,a=new Cesium.Matrix4,r=new Cesium.Cartographic,n=i.parent.viewer.scene,o=i.parent.viewer.scene.camera,s=n.screenSpaceCameraController,l=(s.enableCollisionDetection,s.minimumCollisionTerrainHeight),c=s.minimumZoomDistance,u=n.globe,m=u.ellipsoid;n.mapProjection}Cesium.Matrix4.equals(o.transform,Cesium.Matrix4.IDENTITY)||(e=Cesium.Matrix4.clone(o.transform,a),t=Cesium.Cartesian3.magnitude(o.position),o._setTransform(Cesium.Matrix4.IDENTITY));var C=r;m.cartesianToCartographic(o.position,C);var d=!1;if(C.height<l){var p=u.getHeight(C);void 0!==p&&null!==p&&(p+=c,C.height<p&&(C.height=p,m.cartographicToCartesian(C,o.position),d=!0))}void 0!==e&&null!==e&&(o._setTransform(e),d&&(Cesium.Cartesian3.normalize(o.position,o.position),Cesium.Cartesian3.negate(o.position,o.direction),Cesium.Cartesian3.multiplyByScalar(o.position,Math.max(t,c),o.position),Cesium.Cartesian3.normalize(o.direction,o.direction),Cesium.Cartesian3.cross(o.direction,o.up,o.right),Cesium.Cartesian3.cross(o.right,o.direction,o.up)))},CustomRenderLoop=function(e,t,i){this.map2D=e,this.listentTo=[TC.Consts.event.LAYERADD,TC.Consts.event.LAYERORDER,TC.Consts.event.LAYERREMOVE,TC.Consts.event.LAYEROPACITY,TC.Consts.event.LAYERVISIBILITY,TC.Consts.event.ZOOM,TC.Consts.event.BASELAYERCHANGE].join(" "),this.map3D=t,this.scene_=this.map3D.scene,this.verboseRendering=i,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this.lastCameraViewMatrix_=new Cesium.Matrix4,this.lastCameraMoveTime_=0,this.stoppedRendering=!1,this._removePostRenderListener=this.scene_.postRender.addEventListener(this.postRender.bind(this)),this._wheelEvent="",this._wheelEvent="onwheel"in this.scene_.canvas?"wheel":document.onmousewheel?"mousewheel":"DOMMouseScroll",this._originalLoadWithXhr=Cesium.loadWithXhr.load,this._originalScheduleTask=Cesium.TaskProcessor.prototype.scheduleTask,this._originalCameraSetView=Cesium.Camera.prototype.setView,this._originalCameraMove=Cesium.Camera.prototype.move,this._originalCameraRotate=Cesium.Camera.prototype.rotate,this._originalCameraLookAt=Cesium.Camera.prototype.lookAt,this._originalCameraFlyTo=Cesium.Camera.prototype.flyTo,this.enable()},CustomRenderLoop.prototype.repaintOn_=function(e,t){var i=this.scene_.canvas;i.addEventListener(e,this._boundNotifyRepaintRequired,t)},CustomRenderLoop.prototype.removeRepaintOn_=function(e,t){var i=this.scene_.canvas;i.removeEventListener(e,this._boundNotifyRepaintRequired,t)},CustomRenderLoop.prototype.enable=function(){this.repaintOn_("mousemove",!1),this.repaintOn_("mousedown",!1),this.repaintOn_("mouseup",!1),this.repaintOn_("touchstart",!1),this.repaintOn_("touchend",!1),this.repaintOn_("touchmove",!1),window.PointerEvent&&(this.repaintOn_("pointerdown",!1),this.repaintOn_("pointerup",!1),this.repaintOn_("pointermove",!1)),this.repaintOn_(this._wheelEvent,!1),window.addEventListener("resize",this._boundNotifyRepaintRequired,!1);var e=this;Cesium.loadWithXhr.load=function(t,i,a,r,n,o,s,l,c){o.promise.always(e._boundNotifyRepaintRequired),e._originalLoadWithXhr(t,i,a,r,n,o,s,l,c)},Cesium.TaskProcessor.prototype.scheduleTask=function(t,i){var a=e._originalScheduleTask.call(this,t,i),r=this;if(!r._originalWorkerMessageSinkRepaint){var n=r._worker;r._originalWorkerMessageSinkRepaint=n.onmessage,n.onmessage=function(t){r._originalWorkerMessageSinkRepaint(t),e.notifyRepaintRequired()}}return a},Cesium.Camera.prototype.setView=function(){e._originalCameraSetView.apply(this,arguments),e.notifyRepaintRequired()},Cesium.Camera.prototype.move=function(){e._originalCameraMove.apply(this,arguments),e.notifyRepaintRequired()},Cesium.Camera.prototype.rotate=function(){e._originalCameraRotate.apply(this,arguments),e.notifyRepaintRequired()},Cesium.Camera.prototype.lookAt=function(){e._originalCameraLookAt.apply(this,arguments),e.notifyRepaintRequired()},Cesium.Camera.prototype.flyTo=function(){e._originalCameraFlyTo.apply(this,arguments),e.notifyRepaintRequired()},this.map2D.on(this.listentTo,this._boundNotifyRepaintRequired)},CustomRenderLoop.prototype.disable=function(){this._removePostRenderListener&&(this._removePostRenderListener(),this._removePostRenderListener=void 0),this.removeRepaintOn_("mousemove",!1),this.removeRepaintOn_("mousedown",!1),this.removeRepaintOn_("mouseup",!1),this.removeRepaintOn_("touchstart",!1),this.removeRepaintOn_("touchend",!1),this.removeRepaintOn_("touchmove",!1),window.PointerEvent&&(this.removeRepaintOn_("pointerdown",!1),this.removeRepaintOn_("pointerup",!1),this.removeRepaintOn_("pointermove",!1)),this.removeRepaintOn_(this._wheelEvent,!1),window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),Cesium.loadWithXhr.load=this._originalLoadWithXhr,Cesium.TaskProcessor.prototype.scheduleTask=this._originalScheduleTask,Cesium.Camera.prototype.setView=this._originalCameraSetView,Cesium.Camera.prototype.move=this._originalCameraMove,Cesium.Camera.prototype.rotate=this._originalCameraRotate,Cesium.Camera.prototype.lookAt=this._originalCameraLookAt,Cesium.Camera.prototype.flyTo=this._originalCameraFlyTo,this.map2D.off(this.listentTo,this._boundNotifyRepaintRequired)},CustomRenderLoop.prototype.postRender=function(e){var t=Date.now(),i=this.scene_,a=i.camera;Cesium.Matrix4.equalsEpsilon(this.lastCameraViewMatrix_,a.viewMatrix,1e-5)||(this.lastCameraMoveTime_=t);var r=t-this.lastCameraMoveTime_<3e3,n=i.globe._surface,o=!n._tileProvider.ready||n._tileLoadQueueHigh.length>0||n._tileLoadQueueMedium.length>0||n._tileLoadQueueLow.length>0||n._debug.tilesWaitingForChildren>0,s=i.tweens;r||o||0!=s.length||(this.verboseRendering&&console.log("stopping rendering @ "+Date.now()),this.parent.setBlockRendering(!0),this.stoppedRendering=!0),Cesium.Matrix4.clone(a.viewMatrix,this.lastCameraViewMatrix_)},CustomRenderLoop.prototype.restartRenderLoop=function(){this.notifyRepaintRequired()},CustomRenderLoop.prototype.notifyRepaintRequired=function(){this.verboseRendering&&this.stoppedRendering&&console.log("starting rendering @ "+Date.now()),this.lastCameraMoveTime_=Date.now(),this.parent.setBlockRendering(!1),this.stoppedRendering=!1},CustomRenderLoop.prototype.setDebug=function(e){this.verboseRendering=e},idRequestAnimationFrame=null,e.Cesium={CustomRender:{_blockRendering:!1,_canvasClientWidth:0,_canvasClientHeight:0,_resolutionScale:1,_canvas:null,_clock:null,_handleResize:function(e){var t=this._canvas.clientWidth,i=this._canvas.clientHeight;if(!(0===t|0===i||t===this._canvasClientWidth&&i===this._canvasClientHeight)){var a=this._resolutionScale;this._canvasClientWidth=t,this._canvasClientHeight=i,t*=a,i*=a,this._canvas.width=t,this._canvas.height=i,e.scene.camera.frustum.aspectRatio=t/i}},_renderingAnimation:function(e){function t(){if(i._blockRendering)i._clock.tick();else{a.scene.initializeFrame(),i._handleResize(a);var e=i._clock.tick()||Cesium.JulianDate.now();a.scene.render(e)}idRequestAnimationFrame=requestAnimationFrame(t)}var i=this,a=e;idRequestAnimationFrame=requestAnimationFrame(t)},start:function(e,t,i){this._canvas=t.scene.canvas,this._clock=t.clock||new Cesium.Clock,i&&(this._resolutionScale=.5),this.customRender=new CustomRenderLoop(e,t,!0),this.customRender.parent=this,this._renderingAnimation(t)},stop:function(){window.cancelAnimationFrame(idRequestAnimationFrame)},setBlockRendering:function(e){this._blockRendering=e}},arePendingTiles:function(){var e=this,t=e.viewer.scene.globe._surface;return!t._tileProvider.ready||t._tileLoadQueueHigh.length>0||t._tileLoadQueueMedium.length>0||t._tileLoadQueueLow.length>0||t._debug.tilesWaitingForChildren>0},getCesium:function(){var e=new $.Deferred;return window.Cesium?e.resolve():TC.loadJS(!window.Cesium,[TC.Consts.url.CESIUM],function(){e.resolve()}),e},getTerrainProvider:function(){var e=this;return e.terrainProvider||(e.terrainProvider=new Cesium.CesiumTerrainProvider({url:"https://pmpwvinet18.tcsa.local/customcesiumterrain/epsg3857/geodetic/_5m/5m",requestWaterMask:!0,requestVertexNormals:!0})),e.terrainProvider},getViewer:function(){var e=this,t=new $.Deferred;return e.viewer?t.resolve(e.viewer):e.Cesium.getCesium().then(function(){var i=new Cesium.Globe;if(i.baseColor=Cesium.Color.WHITE,i.enableLighting=!0,e.viewer=e.Cesium._viewer=new Cesium.Viewer(e.selectors.divThreedMap,{terrainProvider:e.Cesium.getTerrainProvider(),terrainExaggeration:1,terrainShadows:Cesium.ShadowMode.ENABLED,animation:!1,timeline:!1,fullscreenButton:!1,baseLayerPicker:!1,imageryProvider:!1,navigationInstructionsInitiallyVisible:!1,navigationHelpButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,globe:i,useDefaultRenderLoop:!e.options.customRender}),e.options.customRender&&e.Cesium.CustomRender.start(e.map,e.viewer,e.isSlower),e.viewer.readyPromise=new $.Deferred,e.viewer.scene.backgroundColor=Cesium.Color.WHITE,e.viewer.scene.screenSpaceCameraController.enableCollisionDetection=!0,e.viewer.scene.screenSpaceCameraController.maximumZoomDistance=5e5,e.viewer.scene.imageryLayers.removeAll(),e.options&&e.options.showTileCoordinates){var a;e.$divThreedMap.append('<button class="tc-ctl-threed-show-tile-btn"></button>'),e.$btnShowTileCoords=$(".tc-ctl-threed-show-tile-btn"),e.$btnShowTileCoords.on(TC.Consts.event.CLICK,function(){$(this).hasClass("showing")?(e.viewer.scene.imageryLayers.raiseToTop(a),e.viewer.scene.imageryLayers.remove(a,!0)):a=e.viewer.scene.imageryLayers.addImageryProvider(new Cesium.TileCoordinatesImageryProvider),$(this).toggleClass("showing")})}e.viewer.terrainProvider.errorEvent.addEventListener(e.Cesium.Events.tileProviderError.bind(e)),e.viewer.scene.renderError.addEventListener(e.Cesium.Events.renderError.bind(e)),e.Cesium.Util.tileLoadHelper=new Cesium.EventHelper,e.Cesium.Util.tileLoadHelper.add(e.viewer.scene.globe.tileLoadProgressEvent,function(t){e.waitting||(e.waitting=e.map.getLoadingIndicator().addWait()),0===t&&(e.map.getLoadingIndicator().removeWait(e.waitting),delete e.waitting,e.viewer.readyPromise.resolve())}.bind(e)),e.Cesium.Util.zoomHandler.call(e),$(".cesium-viewer-bottom").remove(),t.resolve(e.viewer)}),t},setCameraFromMapView:function(){var e=this,t=e.mapView.getCenter(),i=TC.Util.reproject(t,e.map.crs,e.crs);e.distance=e.Cesium.Util.calcDistanceForResolution.call(e,e.mapView.getResolution()||0,Cesium.Math.toRadians(i[0])),e.Cesium.Camera.updateCamera.call(e)},setViewFromCameraView:function(){var e=this;if(!e.setViewFromCameraViewInProgress||"resolved"==e.setViewFromCameraViewInProgress.state()){e.setViewFromCameraViewInProgress=new $.Deferred;{var t=Cesium.Ellipsoid.WGS84,i=e.viewer.scene;target_=e.Cesium.Util.pickCenterPoint(i)}if(!target_){var a=e.viewer.scene.globe,r=e.viewer.camera.positionCartographic.clone(),n=a.getHeight(r);r.height=n||0,target_=Cesium.Ellipsoid.WGS84.cartographicToCartesian(r)}e.distance=Cesium.Cartesian3.distance(target_,e.viewer.camera.position);var o=t.cartesianToCartographic(target_),s=TC.Util.reproject([Cesium.Math.toDegrees(o.longitude),Cesium.Math.toDegrees(o.latitude)],e.crs,e.map.crs);e.mapView.setCenter(s),e.mapView.setResolution(e.Cesium.Util.calcResolutionForDistance.call(e,e.distance,o?o.latitude:0)),e.setViewFromCameraViewInProgress.resolve()}return e.setViewFromCameraViewInProgress},Events:{Zoom:{_toZoom:{
direction:1,amount:0,endPosition:{}},zoom:function(e,t){var i=this,a=i.viewer.scene;if(!e||!e.endPosition){var r=a.canvas,n=new Cesium.Cartesian2(r.clientWidth/2,r.clientHeight/2);e={endPosition:n}}var o=a.camera.getPickRay(e.endPosition),s=a.globe.pick(o,a);if(s){var l=Cesium.Cartesian3.distance(o.origin,s);if(1>l)return;i.Cesium.Events.Zoom._toZoom.direction=t>0?1:0,i.Cesium.Events.Zoom._toZoom.amount+=5*l/100,i.Cesium.Events.Zoom._toZoom.endPosition=e.endPosition}var c=function(t){var i=this,a=i.viewer.scene,r=a.camera.getPickRay(e.endPosition||t.endPosition),n=a.globe.pick(r,a);if(n){var o=Cesium.Cartesian3.distance(r.origin,n);if(1>o)return;var s=a.camera.position,l=(a.camera.direction,toGo=new Cesium.Cartesian3);Cesium.Cartesian3.multiplyByScalar(r.direction,1==t.direction?t.amount:-t.amount,l),Cesium.Cartesian3.add(s,l,toGo);var c=new Cesium.Ray(toGo,r.direction),u=a.globe.pick(c,a);if(u){var m=function(){this.Cesium.Events.Zoom._toZoom={direction:1,amount:0,endPosition:{}}};Cesium.Cartesian3.distance(toGo,u)<1||Cesium.Ellipsoid.WGS84.cartesianToCartographic(toGo).height>a.screenSpaceCameraController.maximumZoomDistance||Math.abs(Cesium.Ellipsoid.WGS84.cartesianToCartographic(toGo).height)<a.screenSpaceCameraController.minimumZoomDistance?m.call(i):i.viewer.camera.flyTo({destination:toGo,orientation:{heading:a.camera.heading,pitch:a.camera.pitch,roll:a.camera.roll},duration:1,easingFunction:Cesium.EasingFunction.LINEAR_NONE,complete:function(e){this.Cesium.Events.Zoom._toZoom={direction:1,amount:0,endPosition:{}}}.bind(i,Cesium.Cartesian3.distance(toGo,u))})}}};setTimeout(function(){c.call(i,i.Cesium.Events.Zoom._toZoom)}.bind(i),50)},buttomsZoom:function(e,t){var i=this;i.Cesium.Events.Zoom.zoom.call(i,{endPosition:e},t)},wheelZoom:function(e){var t=this;t.Cesium.Events.Zoom.zoom.call(t,t.Cesium._mousePosition,e)}},renderError:function(e){var t=this;t.$divThreedMap.addClass(t.classes.LOADING),t.map.toast("Error",{type:TC.Consts.msgType.ERROR})},tileProviderError:function(e){switch(e.error.statusCode){case 403:case 404:}}},Camera:{limitCamera:function(){var e=this,t=e.viewer.camera.positionCartographic.clone();if(!(t.longitude>=e.initExtent.west&&t.longitude<=e.initExtent.east&&t.latitude>=e.initExtent.south&&t.latitude<=e.initExtent.north)){var i=e.viewer.scene.screenSpaceCameraController.maximumZoomDistance,a=.05*t.height/i;t.longitude=Math.max(e.initExtent.west-a,t.longitude),t.latitude=Math.max(e.initExtent.south-a,t.latitude),t.longitude=Math.min(e.initExtent.east+a,t.longitude),t.latitude=Math.min(e.initExtent.north+a,t.latitude),e.viewer.camera.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(t),orientation:{heading:e.viewer.camera.heading,pitch:e.viewer.camera.pitch}})}e.viewer.scene.screenSpaceCameraController.minimumZoomDistance=t.height>1800?400:200},updateCamera:function(){var e=this,t=e.mapView.getCenter();if(t){var i=TC.Util.reproject(t,e.map.crs,e.crs),a=new Cesium.Cartographic(Cesium.Math.toRadians(i[0]),Cesium.Math.toRadians(i[1]));e.viewer.scene.globe&&(a.height=e.viewer.scene.globe.getHeight(a)||0);var r=Cesium.Ellipsoid.WGS84.cartographicToCartesian(a),n={pitch:Cesium.Math.toRadians(-90),heading:-e.mapView.getRotation(),roll:0};e.viewer.camera.setView({destination:r,orientation:n}),e.viewer.camera.moveBackward(e.distance)}},getCamera:function(){var e=this;return e.viewer.scene.camera},getHeight:function(){var e=this;return Cesium.Ellipsoid.WGS84.cartesianToCartographic(e.Cesium.Camera.getCamera.call(e).position).height}},Util:{calcDistanceForResolution:function(e,t){var i=this,a=i.viewer.camera.frustum.fovy,r=i.mapView.proj4Obj.oProj.METERS_PER_UNIT,n=e*i.mapView.viewHTML.getBoundingClientRect().height,o=Math.cos(Math.abs(t)),s=n*r*o;return s/2/Math.tan(a/2)},calcResolutionForDistance:function(e,t){var i=this,a=i.viewer.scene.canvas,r=i.viewer.camera.frustum.fovy,n=i.mapView.proj4Obj.oProj.METERS_PER_UNIT,o=2*e*Math.tan(r/2),s=Math.cos(Math.abs(t)),l=o/n/s,c=l/a.clientHeight,u=i.map.getResolutions();if(null==u){u=new Array(22);for(var m=0,C=u.length;C>m;++m)u[m]=i.mapView.getMaxResolution()/Math.pow(2,m)}for(var m=0;m<u.length;m++)if(u[m]<c){c=u[m];break}return c},rotateAroundAxis:function(e,t,i,a,r){function n(r){o||(o=r);var l=C(s((r-o)/u,0,1));e.transform.clone(v);var c=(l-p)*t;p=l,e.lookAtTransform(a),e.rotate(i,c),e.lookAtTransform(v),1>l?requestAnimationFrame(n):(d&&d(),h.resolve())}var o,s=Cesium.Math.clamp,l=Cesium.defaultValue,c=r||{},u=l(c.duration,500),m=function(e){return e},C=l(c.easing,m),d=c.callback,p=0,v=new Cesium.Matrix4,h=new $.Deferred;return requestAnimationFrame(n),h},pickOnTerrainOrEllipsoid:function(e,t){var i=e.camera.getPickRay(t),a=e.globe.pick(i,e);return a||e.camera.pickEllipsoid(t)},pickCenterPoint:function(e){var t=this,i=e.canvas,a=new Cesium.Cartesian2(i.clientWidth/2,i.clientHeight/2);return t.pickOnTerrainOrEllipsoid(e,a)},pickBottomPoint:function(e){var t=this,i=e.canvas,a=new Cesium.Cartesian2(i.clientWidth/2,i.clientHeight);return t.pickOnTerrainOrEllipsoid(e,a)},bottomFovRay:function(e){var t=e.camera,i=t.frustum.fovy/2,a=t.direction,r=Cesium.Quaternion.fromAxisAngle(t.right,i),n=Cesium.Matrix3.fromQuaternion(r),o=new Cesium.Cartesian3;return Cesium.Matrix3.multiplyByVector(n,a,o),new Cesium.Ray(t.position,o)},setHeadingUsingBottomCenter:function(e,t,i,a){var r=this,n=e.camera,o=r.computeAngleToZenith(e,i),s=n.right,l=Cesium.Quaternion.fromAxisAngle(s,o),c=Cesium.Matrix3.fromQuaternion(l),u=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(n.position,i,u);var m=new Cesium.Cartesian3;Cesium.Matrix3.multiplyByVector(c,u,m),Cesium.Cartesian3.add(m,i,m);var C=Cesium.Matrix4.fromTranslation(m);r.rotateAroundAxis(n,t,m,C,a)},signedAngleBetween:function(e,t,i){var a=new Cesium.Cartesian3,r=new Cesium.Cartesian3,n=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(e,a),Cesium.Cartesian3.normalize(t,r),Cesium.Cartesian3.cross(a,r,n);var o=Cesium.Cartesian3.dot(a,r),s=Cesium.Cartesian3.magnitude(n),l=Cesium.Cartesian3.dot(i,n),c=Math.atan2(s,o);return l>=0?c:-c},computeAngleToZenith:function(e,t){var i=this,a=e.camera,r=a.frustum.fovy/2,n=i.bottomFovRay(e),o=Cesium.Cartesian3.clone(n.direction);Cesium.Cartesian3.negate(o,o);var s=new Cesium.Cartesian3;Cesium.Ellipsoid.WGS84.geocentricSurfaceNormal(t,s);var l=new Cesium.Cartesian3;Cesium.Cartesian3.negate(a.right,l);var c=i.signedAngleBetween(s,o,l);return c+r},computeSignedTiltAngleOnGlobe:function(e){var t=this,i=e.camera,a=new Cesium.Ray(i.position,i.direction),r=e.globe.pick(a,e);if(!r){var n=Cesium.Ellipsoid.WGS84,o=Cesium.IntersectionTests.rayEllipsoid(a,n);o&&(r=Cesium.Ray.getPoint(a,o.start))}if(!r)return void 0;var s=new Cesium.Cartesian3;Cesium.Ellipsoid.WGS84.geocentricSurfaceNormal(r,s);var l=t.signedAngleBetween,c=l(i.direction,s,i.right)-Math.PI;return Cesium.Math.convertLongitudeRange(c)},zoomHandler:function(){var e=this;if(!TC.Util.detectMobile()){e.viewer.scene.screenSpaceCameraController.enableZoom=!1;var t,i=e.viewer.scene.canvas;t="onwheel"in i?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",i.addEventListener(t,function(t){var i;if(t.deltaY){var a=t.deltaMode;i=a===t.DOM_DELTA_PIXEL?-t.deltaY:a===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else i=t.detail>0?-120*t.detail:t.wheelDelta;e.Cesium.Events.Zoom.wheelZoom.call(e,i)},!1);var a=new Cesium.ScreenSpaceEventHandler(e.viewer.scene.canvas);a.setInputAction(function(t){e.Cesium._mousePosition=t},Cesium.ScreenSpaceEventType.MOUSE_MOVE),a.setInputAction(function(t){e.Cesium.Events.Zoom.wheelZoom.call(e,t)},Cesium.ScreenSpaceEventType.WHEEL);var r=new Cesium.Cartesian2,n=0;a.setInputAction(function(e){Cesium.Cartesian2.lerp(e.position1,e.position2,.5,r)},Cesium.ScreenSpaceEventType.PINCH_START),a.setInputAction(function(t){var i=t.distance.endPosition.y-t.distance.startPosition.y,a=i/e.viewer.scene.canvas.clientHeight;a=Math.min(a,e.viewer.scene.screenSpaceCameraController.maximumMovementRatio),n=a},Cesium.ScreenSpaceEventType.PINCH_MOVE),a.setInputAction(function(t){e.Cesium.Events.Zoom.zoom.call(e,{endPosition:r},n)},Cesium.ScreenSpaceEventType.PINCH_END)}}}},e.OverrideControls={adapter:function(e){for(var t=this,i=0,a=t.map.controls.length;a>i;i++){var r=t.map.controls[i];if(t.ctrlsToMng.indexOf(r)<0)switch(!0){case t.direction.TO_TWO_D==e:r.enable();break;case t.direction.TO_THREE_D==e:r.disable()}}switch(!0){case t.direction.TO_TWO_D==e:$("[data-no-3d]").removeClass(TC.Consts.classes.HIDDEN);break;case t.direction.TO_THREE_D==e:$("[data-no-3d]").addClass(TC.Consts.classes.HIDDEN)}},Cfg:{zoomAmount:200},Events:{initialExtent:function(e){var t=this;t.map.options.initialExtent&&4==t.map.options.initialExtent.length&&$.when(t.map.setExtent(t.map.options.initialExtent)).then(function(){var e=t.map.getExtent(),i=TC.Util.reproject(e.slice(0,2),t.map.crs,t.crs),a=TC.Util.reproject(e.slice(2),t.map.crs,t.crs);t.initExtent=Cesium.Rectangle.fromDegrees(i[0],i[1],a[0],a[1]),Cesium.Camera.DEFAULT_VIEW_RECTANGLE=t.initExtent,Cesium.Camera.DEFAULT_VIEW_FACTOR=0,t.viewer.camera.flyHome(4)}.bind(t))},zoomin:function(e){var t=this,i=new Cesium.Cartesian2(t.viewer.scene.canvas.clientWidth/2,t.viewer.scene.canvas.clientHeight/2);t.Cesium.Events.Zoom.buttomsZoom.call(t,i,t.OverrideControls.Cfg.zoomAmount)},zoomout:function(e){var t=this,i=new Cesium.Cartesian2(t.viewer.scene.canvas.clientWidth/2,t.viewer.scene.canvas.clientHeight/2);t.Cesium.Events.Zoom.buttomsZoom.call(t,i,-t.OverrideControls.Cfg.zoomAmount)}}},e.BaseMap={analogLayers:{layers:[],getProperties:function(e){var t=this;return e.options&&e.options.hasOwnProperty("4326")?(t.BaseMap.analogLayers.layers.push({id:e.id,opts:e.options[4326]}),t.BaseMap.analogLayers.layers[t.BaseMap.analogLayers.layers.length-1].opts):null},findById:function(e){if(0==this.layers.length)return null;for(var t=0;t<this.layers.length;t++)if(this.layers[t].id.toLowerCase().trim()===e.toLowerCase().trim())return this.layers[t].opts;return null}},synchronizer:function(e){var t=this;switch(!0){case t.direction.TO_TWO_D==e:t.BaseMap.Util.addNoCompatibleBaseLayers.call(t),t.map.baseLayer=t.currentMapCfg.baseMap==t.Consts.BLANK_BASE?t.currentMapCfg.baseVector:t.currentMapCfg.baseMap,t.map.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:t.map.baseLayer}));break;case t.direction.TO_THREE_D==e:if(t.BaseMap.Util.checkCompatibleBaseMaps.call(t),t.BaseMap.Util.removeNoCompatibleBaseLayers.call(t),t.map.baseLayer instanceof TC.layer.Raster){var i=t.map.baseLayer;i.options.relatedWMTS?(t.map.baseLayer=i=t.map.getLayer(i.options.relatedWMTS),t.map.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:t.map.baseLayer}))):null!=(obj=t.BaseMap.analogLayers.findById(t.map.baseLayer.id))&&($.extend(obj,{map:t.map}),i=new TC.layer.Raster(obj),i.isBase=!0),t.Raster.synchronizer.call(t,i)}else t.baseLayer=t.Consts.BLANK_BASE}},Events:{beforeBaseLayerChanged:function(e){var t=this;t.waitting||(t.waitting=t.map.getLoadingIndicator().addWait())},baseLayerChanged:function(e){var t=this;if(t.baseLayer&&t.baseLayer!==t.Consts.BLANK_BASE&&(t.viewer.scene.imageryLayers.raiseToTop(t.baseLayer),t.viewer.scene.imageryLayers.remove(t.baseLayer,!0)),e.layer instanceof TC.layer.Vector)t.baseLayer=t.Consts.BLANK_BASE;else{var i=e.layer;null!=(obj=t.BaseMap.analogLayers.findById(e.layer.id))&&($.extend(obj,{map:t.map}),i=new TC.layer.Raster(obj),i.isBase=!0),t.Raster.synchronizer.call(t,i)}t.currentMapCfg.baseMap=t.map.baseLayer}},Util:{checkCompatibleBaseMaps:function(){var e=this,t=e.map.baseLayer instanceof TC.layer.Raster;if(t?null==(crs=e.Raster.isCompatible.call(e,e.map.baseLayer))&&null==e.BaseMap.analogLayers.getProperties.call(e,e.map.baseLayer)&&e.map.toast(e.getLocaleString("threed.baseLayerNoCompatible",{name:e.map.baseLayer.layerNames})):e.currentMapCfg.baseVector=e.map.baseLayer,0===e.currentMapCfg.baseMaps.length)for(var i=0;i<e.map.baseLayers.length;i++)e.map.baseLayers[i]instanceof TC.layer.Raster&&!e.Raster.isCompatible.call(e,e.map.baseLayers[i])&&null==e.BaseMap.analogLayers.getProperties.call(e,e.map.baseLayers[i])&&e.currentMapCfg.baseMaps.push({l:e.map.baseLayers[i],i:i});e.currentMapCfg.baseMap=t?e.map.baseLayer:e.Consts.BLANK_BASE},removeNoCompatibleBaseLayers:function(){var e=this,t=!1;if(e.currentMapCfg.baseMaps&&e.currentMapCfg.baseMaps.length){for(var i=0;i<e.currentMapCfg.baseMaps.length;i++)for(var a=0;a<e.map.baseLayers.length;a++)if(e.map.baseLayers[a]===e.currentMapCfg.baseMaps[i].l){e.currentMapCfg.baseMap==e.map.baseLayers[a]&&(t=!0),e.map.$events.trigger($.Event(TC.Consts.event.LAYERREMOVE,{layer:e.map.baseLayers[a]})),e.map.baseLayers.splice(a,1);break}t&&(e.map.baseLayer=e.map.baseLayers[0],e.map.$events.trigger($.Event(TC.Consts.event.BASELAYERCHANGE,{layer:e.map.baseLayer})))}},addNoCompatibleBaseLayers:function(){var e=this;if(e.currentMapCfg.baseMaps&&e.currentMapCfg.baseMaps.length)for(var t=0;t<e.currentMapCfg.baseMaps.length;t++)e.map.$events.trigger($.Event(TC.Consts.event.LAYERADD,{layer:e.currentMapCfg.baseMaps[t].l})),e.map.baseLayers.splice(e.currentMapCfg.baseMaps[t].i,0,e.currentMapCfg.baseMaps[t].l)}}},e.Layer={synchronizer:function(){for(var e=this,t=e.map.workLayers.slice().reverse(),i=0;i<t.length;i++){var a=t[i];a instanceof TC.layer.Raster&&e.Raster.synchronizer.call(e,a)}},Events:{layerAdded:function(e){var t=this;t.Raster.synchronizer.call(t,e.layer)},layerRemoved:function(e){for(var t=this,i=0;i<t.workLayers.length;i++)if(t.workLayers[i].imageryProvider.layers.join(",")===e.layer.names.join(",")){t.viewer.scene.imageryLayers.raiseToTop(t.workLayers[i]),t.viewer.scene.imageryLayers.remove(t.workLayers[i],!0),t.workLayers.splice(i,1);break}},layerVisibility:function(e){for(var t=this,i=0;i<t.workLayers.length;i++)if(t.workLayers[i].imageryProvider.layers.join(",")===e.layer.names.join(",")){t.workLayers[i].show=e.layer.getVisibility();break}},layerOpacity:function(e){for(var t=this,i=0;i<t.workLayers.length;i++)if(t.workLayers[i].imageryProvider.layers.join(",")===e.layer.names.join(",")){t.workLayers[i].alpha=e.layer.getOpacity();break}},layerOrder:function(e){for(var t=this,i=0;i<t.workLayers.length;i++)if(t.workLayers[i].imageryProvider&&t.workLayers[i].imageryProvider.layers.join(",")===e.layer.names.join(",")){if(e.oldIndex>e.newIndex)for(var a=e.oldIndex-e.newIndex,r=0;a>r;r++)t.viewer.scene.imageryLayers.lower(t.workLayers[i]);else for(var a=e.newIndex-e.oldIndex,r=0;a>r;r++)t.viewer.scene.imageryLayers.raise(t.workLayers[i]);t.workLayers.splice(e.newIndex,0,t.workLayers.splice(e.oldIndex,1)[0]);break}}}},e.Raster={isCompatible:function(e){var t=this,i=t.Util.getCRSByLayerOnCapabilities(e);return i&&i.length&&t.crsPattern.test(i.join(","))?i.join(",").match(t.crsPattern)[0]:null},getWMTSLayerSynchronizer:function(e,t){var i=this.Util.getTileMatrixSetLabelByLayerOnCapabilities(e,t);return new Cesium.WebMapTileServiceImageryProvider({url:e.options.urlPattern,layer:e.layerNames,style:"default",format:e.format||e.options.format,tileMatrixSetID:t,tileMatrixLabels:i,tilingScheme:new Cesium.GeographicTilingScheme})},getWMSLayerSynchronizer:function(e){return new Cesium.WebMapServiceImageryProvider({url:e.url,layers:e.layerNames,parameters:{transparent:!0,format:e.format||e.options.format}})},synchronizer:function(e){var t=this;if(e instanceof TC.layer.Raster){var i;switch(!0){case TC.Consts.layerType.WMTS==e.type:null!=(crs=t.Raster.isCompatible.call(t,e))?i=t.Raster.getWMTSLayerSynchronizer.call(t,e,crs):t.map.toast(t.getLocaleString("threed.crsNoCompatible",{name:e.layerNames}));break;case TC.Consts.layerType.WMS==e.type:null!=(crs=t.Raster.isCompatible.call(t,e))?i=t.Raster.getWMSLayerSynchronizer(e):t.map.toast(t.getLocaleString("threed.crsNoCompatible",{name:e.layerNames}))}if(i){var a=t.viewer.scene.imageryLayers.addImageryProvider(i);e.isBase?(t.baseLayer=a,t.viewer.scene.imageryLayers.lowerToBottom(a)):(a.show=e.getVisibility(),a.alpha=e.getOpacity(),t.workLayers.push(a))}}}},e.Vector={getPosition:function(e){var t=this;return e?TC.Util.reproject(e,t.map.crs,t.crs):void 0},getIcon:function(e){return e.url&&e.width&&e.height?{image:e.url,width:e.width,height:e.height}:void 0},createEntity:function(e){var t,i=this;switch(!0){case e instanceof TC.feature.Marker:var a=this.getPosition.call(i,e.getCoords()),r=this.getIcon.call(i,e.options);t=new Cesium.Entity({position:Cesium.Cartesian3.fromDegrees(a[0],a[1])}),r&&(t.billboard=r);case e instanceof TC.feature.Point:}t&&i.viewer.entities.add(t)},synchronizer:function(e){var t=this;if(e.features&&e.features.length)for(var i=0;i<e.features.length;i++)this.createEntity.call(t,e.features[i])}},e.Util={browserSupportWebGL:function(){var e=this,t=!1;if(window.WebGLRenderingContext){var i=document.createElement("canvas"),a={alpha:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};try{var r=i.getContext("webgl",a)||i.getContext("experimental-webgl",a)||i.getContext("webkit-3d",a)||i.getContext("moz-webgl",a);r?t=!0:(a.failIfMajorPerformanceCaveat=!1,r=i.getContext("webgl",a)||i.getContext("experimental-webgl",a)||i.getContext("webkit-3d",a)||i.getContext("moz-webgl",a),r?(t="slow",e.isSlower=!0):t=!1)}catch(n){console.log(E)}if("slow"===t||!t){var o="slow"===t?"threed.slowSupport.supported":"threed.not.supported";e.map.toast(e.getLocaleString(o),{type:TC.Consts.msgType.WARNING,duration:1e4})}return t}t=!1},paths:{CRS:["Capability","Layer","CRS"],TILEMATRIXSET:["Contents","TileMatrixSet","Identifier"],TILEMATRIXSETLABELS:["Contents","TileMatrixSet"]},getOfPath:function(e,t,i){if(i<t.length-1)return e.hasOwnProperty(t[i])?this.getOfPath(e[t[i]],t,++i):null;if(e instanceof Array){for(var a=[],r=0;r<e.length;r++)e[r].hasOwnProperty(t[i])&&a.push(e[r][t[i]]);return a}return e[t[i]]},getCRSByLayerOnCapabilities:function(e){return(capsURL=TC.Util.isOnCapabilities(e.url))&&(caps=TC.capabilities[capsURL])?this.getOfPath(caps,this.paths.CRS,0)||this.getOfPath(caps,this.paths.TILEMATRIXSET,0):null},getTileMatrixSetLabelByLayerOnCapabilities:function(e,t){if((capsURL=TC.Util.isOnCapabilities(e.url))&&(caps=TC.capabilities[capsURL]))for(var i=this.getOfPath(caps,this.paths.TILEMATRIXSETLABELS,0),a=0;a<i.length;a++)if(i[a].Identifier===t)return this.getOfPath(i[a],["TileMatrix","Identifier"],0);return null},reset3D:function(){var e=this;e.currentMapCfg.baseMap="",e.workLayers=[],e.cameraControls.unbind(),e.Cesium.Util.tileLoadHelper.removeAll(),delete e.Cesium.Util.tileLoadHelper}}}();